{% load i18n static admin_adminlte %}

<ul
  class="nav nav-pills nav-sidebar flex-column"
  data-widget="treeview"
  role="menu"
  data-accordion="false"
>
  <!-- Add icons to the links using the .nav-icon class
           with font-awesome or any other icon font library -->

  {% admin_get_menu as app_list %} {% if app_list %} {% for app in app_list %}
  {% if app.has_perms and not app.pinned %}
  <li class="nav-item {% if 'dashboard' in parent %} menu-open {% endif %}">
    <a
      class="nav-link {% if app_label != app.label and app.url not in request.path|urlencode %} collapsed{% endif %}"
      data-bs-toggle="collapse"
      data-bs-target="#submenu-{{ app.app_label }}"
      href="{{ app.url }}"
    >
      <i class="nav-icon {{ app.icon }}"></i>
      <p>
        {{ app.label|slice:10 }}{% if app.label|length > 10 %}..{% endif %}
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>

    {% if app.models %}
    <ul class="nav nav-treeview">
      {% for model in app.models %} {% if model.url %}
      <li class="nav-item">
        <a
          class="nav-link {% if 'bootstrap-tables' in segment or model.url in request.path|urlencode %} active {% endif %}"
          href="{{ model.url }}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>{{ model.label }}</p>
        </a>
      </li>
      {% else %}
      <li class="nav-item">{{ model.label }}</li>
      {% endif %} {% endfor %}
    </ul>
    {% endif %}
  </li>
  {% endif %} {% endfor %} {% endif %}

  <!-- Dashboard section is commented out to hide it -->
  {% comment %} {% if request.user.is_superuser %}
  <li class="nav-item {% if 'dashboard' in parent %} menu-open {% endif %}">
    <a
      href="#"
      class="nav-link {% if 'dashboard' in parent %} active {% endif %}"
    >
      <i class="nav-icon fas fa-tachometer-alt"></i>
      <p>
        Dashboard
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'admin:index' %}"
          class="nav-link {% if 'index' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Dashboard v1</p>
        </a>
      </li>
    </ul>
  </li>
  {% endif %} {% if not request.user.is_superuser %}
  <li class="nav-item {% if 'dashboard' in parent %} menu-open {% endif %}">
    <a
      href="#"
      class="nav-link {% if 'dashboard' in parent %} active {% endif %}"
    >
      <i class="nav-icon fas fa-tachometer-alt"></i>
      <p>
        Dashboard
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="/"
          class="nav-link {% if 'dashboardv1' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Dashboard v1</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'dashboardv2' %}"
          class="nav-link {% if 'dashboardv2' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Dashboard v2</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'dashboardv3' %}"
          class="nav-link {% if 'dashboardv3' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Dashboard v3</p>
        </a>
      </li>
    </ul>
  </li>
  {% endif %} {% if request.user.is_authenticated and not
  request.user.is_superuser %}
  <li class="nav-item">
    <a
      href="{% url 'widgets' %}"
      class="nav-link {% if 'widgets' in segment %}active{% endif %}"
    >
      <i class="nav-icon fas fa-th"></i>
      <p>
        Widgets
        <span class="right badge badge-danger">New</span>
      </p>
    </a>
  </li>
  <li class="nav-item {% if 'layout' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'layout' in parent %}active{% endif %}">
      <i class="nav-icon fas fa-copy"></i>
      <p>
        Layout Options
        <i class="fas fa-angle-left right"></i>
        <span class="badge badge-info right">6</span>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="{% url 'top_navigation' %}" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Top Navigation</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'top_nav_sidebar' %}" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Top Navigation + Sidebar</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'boxed' %}"
          class="nav-link {% if 'boxed_layout' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Boxed</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'fixed_sidebar' %}"
          class="nav-link {% if 'fixed_layout' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Fixed Sidebar</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'fixed_sidebar_custom' %}"
          class="nav-link {% if 'layout_cuastom' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Fixed Sidebar <small>+ Custom Area</small></p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'fixed_topnav' %}"
          class="nav-link {% if 'fixed_topNav' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Fixed Navbar</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'fixed_footer' %}"
          class="nav-link {% if 'fixed_footer' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Fixed Footer</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'collapsed_sidebar' %}"
          class="nav-link {% if 'collapsed_sidebar' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Collapsed Sidebar</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'charts' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'charts' in parent %}active{% endif %}">
      <i class="nav-icon fas fa-chart-pie"></i>
      <p>
        Charts
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'chartjs' %}"
          class="nav-link {% if 'chartjs' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>ChartJS</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'flot' %}"
          class="nav-link {% if 'flot' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Flot</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'inline' %}"
          class="nav-link {% if 'inline' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Inline</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'uplot' %}"
          class="nav-link {% if 'uplot' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>uPlot</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'ui' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'ui' in parent %}active{% endif %}">
      <i class="nav-icon fas fa-tree"></i>
      <p>
        UI Elements
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'ui_general' %}"
          class="nav-link {% if 'general' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>General</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_icons' %}"
          class="nav-link {% if 'icons' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Icons</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_buttons' %}"
          class="nav-link {% if 'buttons' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Buttons</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_sliders' %}"
          class="nav-link {% if 'sliders' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Sliders</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_modals_alerts' %}"
          class="nav-link {% if 'modals_alerts' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Modals & Alerts</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_navbar_tabs' %}"
          class="nav-link {% if 'navbar_tabs' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Navbar & Tabs</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_timeline' %}"
          class="nav-link {% if 'timeline' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Timeline</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'ui_ribbons' %}"
          class="nav-link {% if 'ribbons' in segment %}active{% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Ribbons</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'forms' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'forms' in parent %} active {% endif %}">
      <i class="nav-icon fas fa-edit"></i>
      <p>
        Forms
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'form_general' %}"
          class="nav-link {% if 'form_general' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>General Elements</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'form_advanced' %}"
          class="nav-link {% if 'advanced_form' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Advanced Elements</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'form_editors' %}"
          class="nav-link {% if 'text_editors' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Editors</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'form_validation' %}"
          class="nav-link {% if 'validation' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Validation</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'tables' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'tables' in parent %} active {% endif %}">
      <i class="nav-icon fas fa-table"></i>
      <p>
        Tables
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'table_simple' %}"
          class="nav-link {% if 'simple_table' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Simple Tables</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'table_data' %}"
          class="nav-link {% if 'data_table' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>DataTables</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'table_jsgrid' %}"
          class="nav-link {% if 'jsGrid' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>jsGrid</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-header">EXAMPLES</li>
  <li class="nav-item">
    <a
      href="{% url 'examples_calendar' %}"
      class="nav-link {% if 'calendar' in segment %} active {% endif %}"
    >
      <i class="nav-icon far fa-calendar-alt"></i>
      <p>
        Calendar
        <span class="badge badge-info right">2</span>
      </p>
    </a>
  </li>
  <li class="nav-item">
    <a
      href="{% url 'examples_gallery' %}"
      class="nav-link {% if 'gallery' in segment %} active {% endif %}"
    >
      <i class="nav-icon far fa-image"></i>
      <p>Gallery</p>
    </a>
  </li>
  <li class="nav-item">
    <a
      href="{% url 'examples_kanban' %}"
      class="nav-link {% if 'kanban_board' in segment %} active {% endif %}"
    >
      <i class="nav-icon fas fa-columns"></i>
      <p>Kanban Board</p>
    </a>
  </li>
  <li class="nav-item {% if 'mailbox' in parent %} menu-open {% endif %}">
    <a
      href="#"
      class="nav-link {% if 'mailbox' in parent %} active {% endif %}"
    >
      <i class="nav-icon far fa-envelope"></i>
      <p>
        Mailbox
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'mailbox_inbox' %}"
          class="nav-link {% if 'inbox' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Inbox</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'mailbox_compose' %}"
          class="nav-link {% if 'compose' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Compose</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'mailbox_read_mail' %}"
          class="nav-link {% if 'read_mail' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Read</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'pages' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'pages' in parent %} active {% endif %}">
      <i class="nav-icon fas fa-book"></i>
      <p>
        Pages
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'examples_invoice' %}"
          class="nav-link {% if 'invoice' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Invoice</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_profile' %}"
          class="nav-link {% if 'profile' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Profile</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_e_commerce' %}"
          class="nav-link {% if 'ecommerce' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>E-commerce</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_projects' %}"
          class="nav-link {% if 'projects' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Projects</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_project_add' %}"
          class="nav-link {% if 'project_add' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Project Add</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_project_edit' %}"
          class="nav-link {% if 'project_edit' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Project Edit</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_project_detail' %}"
          class="nav-link {% if 'project_detail' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Project Detail</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_contacts' %}"
          class="nav-link {% if 'contacts' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Contacts</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_faq' %}"
          class="nav-link {% if 'faq' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>FAQ</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'examples_contact_us' %}"
          class="nav-link {% if 'contact_us' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Contact us</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'extra' in parent %} menu-open {% endif %}">
    <a href="#" class="nav-link {% if 'extra' in parent %} active {% endif %}">
      <i class="nav-icon far fa-plus-square"></i>
      <p>
        Extras
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>
            Login & Register v1
            <i class="fas fa-angle-left right"></i>
          </p>
        </a>
        <ul class="nav nav-treeview">
          <li class="nav-item">
            <a href="{% url 'login_v1' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Login v1</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'registration_v1' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Register v1</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'forgot_password_v1' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Forgot Password v1</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'recover_password_v1' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Recover Password v1</p>
            </a>
          </li>
        </ul>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>
            Login & Register v2
            <i class="fas fa-angle-left right"></i>
          </p>
        </a>
        <ul class="nav nav-treeview">
          <li class="nav-item">
            <a href="{% url 'login_v2' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Login v2</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'registration_v2' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Register v2</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'forgot_password_v2' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Forgot Password v2</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'recover_password_v2' %}" class="nav-link">
              <i class="far fa-circle nav-icon"></i>
              <p>Recover Password v2</p>
            </a>
          </li>
        </ul>
      </li>
      <li class="nav-item">
        <a href="{% url 'lockscreen' %}" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Lockscreen</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'legacy_user_menu' %}"
          class="nav-link {% if 'legacy_user' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Legacy User Menu</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'language_menu' %}"
          class="nav-link {% if 'legacy_menu' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Language Menu</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'error_404' %}"
          class="nav-link {% if 'error_404' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Error 404</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'error_500' %}"
          class="nav-link {% if 'error_500' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Error 500</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'pace' %}"
          class="nav-link {% if 'pace' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Pace</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'blank_page' %}"
          class="nav-link {% if 'blank_page' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Blank Page</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'starter_page' %}"
          class="nav-link {% if 'starter_page' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Starter Page</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item {% if 'search' in parent %} menu-open {% endif %}">
    <a
      href="#"
      class="nav-link {% if 'search' in segment %} active {% endif %}"
    >
      <i class="nav-icon fas fa-search"></i>
      <p>
        Search
        <i class="fas fa-angle-left right"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a
          href="{% url 'search_simple' %}"
          class="nav-link {% if 'search_simple' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Simple Search</p>
        </a>
      </li>
      <li class="nav-item">
        <a
          href="{% url 'search_enhanced' %}"
          class="nav-link {% if 'search_enhanced' in segment %} active {% endif %}"
        >
          <i class="far fa-circle nav-icon"></i>
          <p>Enhanced</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-header">MISCELLANEOUS</li>
  <li class="nav-item">
    <a href="{% url 'iframe' %}" class="nav-link">
      <i class="nav-icon fas fa-ellipsis-h"></i>
      <p>Tabbed IFrame Plugin</p>
    </a>
  </li>
  <li class="nav-item">
    <a href="https://adminlte.io/docs/3.1/" class="nav-link">
      <i class="nav-icon fas fa-file"></i>
      <p>Documentation</p>
    </a>
  </li>
  <li class="nav-header">MULTI LEVEL EXAMPLE</li>
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="fas fa-circle nav-icon"></i>
      <p>Level 1</p>
    </a>
  </li>
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon fas fa-circle"></i>
      <p>
        Level 1
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Level 2</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>
            Level 2
            <i class="right fas fa-angle-left"></i>
          </p>
        </a>
        <ul class="nav nav-treeview">
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="far fa-dot-circle nav-icon"></i>
              <p>Level 3</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="far fa-dot-circle nav-icon"></i>
              <p>Level 3</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="far fa-dot-circle nav-icon"></i>
              <p>Level 3</p>
            </a>
          </li>
        </ul>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Level 2</p>
        </a>
      </li>
    </ul>
  </li>
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="fas fa-circle nav-icon"></i>
      <p>Level 1</p>
    </a>
  </li>
  <li class="nav-header">LABELS</li>
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon far fa-circle text-danger"></i>
      <p class="text">Important</p>
    </a>
  </li>
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon far fa-circle text-warning"></i>
      <p>Warning</p>
    </a>
  </li>
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon far fa-circle text-info"></i>
      <p>Informational</p>
    </a>
  </li>
  {% endif %} {% endcomment %} {% if request.user.is_authenticated %}

  <!-- Book Management Section -->
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon fas fa-book"></i>
      <p>
        Book Management
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="{% url 'publisher_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Publishers</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'category_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Categories</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'author_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Authors</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'book_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Books</p>
        </a>
      </li>
    </ul>
  </li>
  <!-- Book Management Section -->
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon fas fa-book"></i>
      <p>
        BookShelves
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="{% url 'area_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Areas</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'shelf_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Shelves</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'bookshelf_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Assign Book to Shelves</p>
        </a>
      </li>
    </ul>
  </li>
  
  <!-- Bills -->
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon fas fa-file-invoice-dollar"></i>
      <p>
        Bills
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="{% url 'bill_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Bill List</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'bill_create' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Create Bill</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'bill_scan_barcode' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Scan Barcode</p>
        </a>
      </li>
    </ul>
  </li>
  
  <!-- Customers -->
  <li class="nav-item">
    <a href="#" class="nav-link">
      <i class="nav-icon fas fa-users"></i>
      <p>
        Customers
        <i class="right fas fa-angle-left"></i>
      </p>
    </a>
    <ul class="nav nav-treeview">
      <li class="nav-item">
        <a href="{% url 'customer_list' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Customer List</p>
        </a>
      </li>
      <li class="nav-item">
        <a href="{% url 'customer_create' %}" class="nav-link ajax-link">
          <i class="far fa-circle nav-icon"></i>
          <p>Create Customer</p>
        </a>
      </li>
    </ul>
  </li>
  
  <!-- Reservations -->
  <li class="nav-item">
    {% comment %}
    <a href="{% url 'reservation_list' %}" class="nav-link ajax-link">
      {% endcomment %}
      <i class="far fa-circle nav-icon"></i>
      <p>Reservations</p>
    </a>
  </li>
  <li class="nav-item">
    <a href="{% url 'logout' %}" class="nav-link direct-link">
      <i class="fa fa-sign-out-alt nav-icon"></i>
      <p>Logout</p>
    </a>
  </li>
  {% else %}
  <li class="nav-item">
    <a href="{% url 'login' %}" class="nav-link">
      <i class="fa fa-sign-in-alt nav-icon"></i>
      <p>Login</p>
    </a>
  </li>
  <li class="nav-item">
    <a href="{% url 'register' %}" class="nav-link">
      <i class="fa fa-user-plus nav-icon"></i>
      <p>Register</p>
    </a>
  </li>
  {% endif %}

  <!-- AI Chatbot Button -->
  <li class="nav-item mt-3">
    <a href="#" class="nav-link" id="chatbot-toggle">
      <i class="nav-icon fas fa-robot"></i>
      <p>AI Assistant</p>
    </a>
  </li>
</ul>

<!-- Chatbot UI -->
<div id="chatbot-container" class="chatbot-container" style="display: none">
  <div class="chatbot-header">
    <h5>AI Assistant</h5>
    <button id="close-chatbot" class="close-chatbot">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="chatbot-messages" id="chatbot-messages">
    <div class="message bot-message">
      <div class="message-content">
        Hello! I'm your AI assistant. How can I help you today?
      </div>
    </div>
    <!-- Database query suggestion buttons -->
    <div class="message bot-message">
      <div class="message-content">
        Here are some things you can ask me:
        <div class="query-suggestions">
          <button
            class="query-btn"
            onclick="suggestQuery('Show me all publishers')"
          >
            Show publishers
          </button>
          <button
            class="query-btn"
            onclick="suggestQuery('List all categories')"
          >
            Show categories
          </button>
          <button
            class="query-btn"
            onclick="suggestQuery('Show me all authors')"
          >
            Show authors
          </button>
          <button
            class="query-btn"
            onclick="suggestQuery('How many books are in the database?')"
          >
            Book count
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="chatbot-input">
    <input
      type="text"
      id="user-input"
      placeholder="Type your message here..."
      class="form-control"
    />
    <button id="send-message" class="btn btn-primary">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>

<!-- Chatbot CSS -->
<style>
  /* Fix for chatbot visibility issues */
  .chatbot-container {
    position: fixed !important;
    bottom: 20px !important;
    right: 20px !important;
    width: 350px !important;
    height: 500px !important;
    background-color: #fff !important;
    border-radius: 10px !important;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1) !important;
    flex-direction: column !important;
    overflow: hidden !important;
    z-index: 9999 !important; /* Much higher z-index to overcome other elements */
  }

  /* Query suggestion buttons */
  .query-suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    margin-top: 8px;
  }

  .query-btn {
    background-color: #f0f7ff;
    border: 1px solid #cce5ff;
    border-radius: 15px;
    padding: 5px 10px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .query-btn:hover {
    background-color: #007bff;
    color: white;
  }

  /* Rest of your CSS remains the same */
  .chatbot-container.visible {
    display: flex !important;
  }

  .chatbot-header {
    background-color: #007bff;
    color: white;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .chatbot-header h5 {
    margin: 0;
  }

  .close-chatbot {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
  }

  .chatbot-messages {
    flex: 1;
    padding: 15px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
  }

  .message {
    margin-bottom: 10px;
    max-width: 80%;
  }

  .bot-message {
    align-self: flex-start;
  }

  .user-message {
    align-self: flex-end;
  }

  .message-content {
    padding: 10px 15px;
    border-radius: 18px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  }

  .bot-message .message-content {
    background-color: #f1f0f0;
  }

  .user-message .message-content {
    background-color: #007bff;
    color: white;
  }

  .chatbot-input {
    display: flex;
    padding: 10px;
    border-top: 1px solid #e0e0e0;
  }

  .chatbot-input input {
    flex: 1;
    margin-right: 10px;
  }

  #chatbot-toggle {
    position: relative;
  }

  #chatbot-toggle .badge {
    position: absolute;
    top: 5px;
    right: 5px;
  }
</style>

<!-- Chatbot JavaScript - Fixed with better jQuery detection and error handling -->
<script>
  // Simplified approach using pure vanilla JavaScript for reliability
  document.addEventListener("DOMContentLoaded", function () {
    console.log("DOM Content Loaded - Initializing chatbot");

    // Direct DOM references for better performance
    var chatbotToggle = document.getElementById("chatbot-toggle");
    var chatbotContainer = document.getElementById("chatbot-container");
    var closeButton = document.getElementById("close-chatbot");
    var userInput = document.getElementById("user-input");
    var sendButton = document.getElementById("send-message");
    var chatMessages = document.getElementById("chatbot-messages");

    if (!chatbotToggle || !chatbotContainer) {
      console.error("Critical chatbot elements not found!");
      console.log("chatbotToggle found:", !!chatbotToggle);
      console.log("chatbotContainer found:", !!chatbotContainer);
      return;
    }

    console.log("All chatbot elements found, attaching event listeners");

    // Suggestion query function
    window.suggestQuery = function (queryText) {
      if (!userInput || !chatMessages) return;

      // Set the input text
      userInput.value = queryText;

      // Trigger send button click
      sendMessage();
    };

    // Directly toggle chatbot visibility with inline styles
    chatbotToggle.addEventListener("click", function (e) {
      e.preventDefault();
      console.log("Chatbot toggle clicked");

      // Force proper styles to ensure visibility
      if (
        chatbotContainer.style.display === "none" ||
        chatbotContainer.style.display === ""
      ) {
        console.log("Setting chatbot to visible");
        chatbotContainer.style.display = "flex";
        chatbotContainer.style.position = "fixed";
        chatbotContainer.style.zIndex = "9999";
        // Focus the input field
        if (userInput) userInput.focus();
      } else {
        console.log("Setting chatbot to hidden");
        chatbotContainer.style.display = "none";
      }
    });

    // Close button functionality
    if (closeButton) {
      closeButton.addEventListener("click", function () {
        console.log("Close button clicked");
        chatbotContainer.style.display = "none";
      });
    }

    // Send message functionality
    function sendMessage() {
      if (!userInput || !chatMessages) return;

      var message = userInput.value.trim();
      if (message === "") return;

      console.log("Sending message:", message);

      // Create and append user message
      var userMessageDiv = document.createElement("div");
      userMessageDiv.className = "message user-message";
      userMessageDiv.innerHTML =
        '<div class="message-content">' + message + "</div>";
      chatMessages.appendChild(userMessageDiv);

      // Clear input
      userInput.value = "";

      // Scroll to bottom
      chatMessages.scrollTop = chatMessages.scrollHeight;

      // Add loading indicator
      var loadingDiv = document.createElement("div");
      loadingDiv.className = "message bot-message";
      loadingDiv.id = "loading-message";
      loadingDiv.innerHTML =
        '<div class="message-content">Typing<span class="typing-dots">...</span></div>';
      chatMessages.appendChild(loadingDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;

      // Use Gemini API instead of local response simulator
      fetchGeminiResponse(message)
        .then(function (botResponse) {
          // Remove loading indicator
          var loadingMessage = document.getElementById("loading-message");
          if (loadingMessage) chatMessages.removeChild(loadingMessage);

          // Create and append bot response
          var botMessageDiv = document.createElement("div");
          botMessageDiv.className = "message bot-message";
          botMessageDiv.innerHTML =
            '<div class="message-content">' + botResponse + "</div>";
          chatMessages.appendChild(botMessageDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        })
        .catch(function (error) {
          console.error("Error getting Gemini response:", error);

          // Remove loading indicator
          var loadingMessage = document.getElementById("loading-message");
          if (loadingMessage) chatMessages.removeChild(loadingMessage);

          // Show error message
          var errorMessageDiv = document.createElement("div");
          errorMessageDiv.className = "message bot-message";
          errorMessageDiv.innerHTML =
            '<div class="message-content">Sorry, I encountered an error. Please try again later.</div>';
          chatMessages.appendChild(errorMessageDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        });
    }

    // Gemini API integration (using server-side implementation)
    async function fetchGeminiResponse(userMessage) {
      try {
        console.log("Sending message to server-side Gemini API:", userMessage);

        // Call our Django endpoint instead of the Gemini API directly
        const response = await fetch("/api/gemini/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            message: userMessage,
          }),
        });

        console.log("Received response status:", response.status);

        // Parse the response
        const data = await response.json();
        console.log("Server response:", data);

        if (data.error) {
          console.error("Error from server:", data.error);
          return simulateBotResponse(userMessage); // Fall back to local responses on error
        }

        return (
          data.response ||
          "I'm sorry, I couldn't process your request at this time."
        );
      } catch (error) {
        console.error("Error calling server-side Gemini API:", error.message);
        console.error("Full error:", error);
        return simulateBotResponse(userMessage); // Fall back to local responses if API fails
      }
    }

    // Simple response simulator (fallback if API fails)
    function simulateBotResponse(userInput) {
      userInput = userInput.toLowerCase();

      if (userInput.includes("hello") || userInput.includes("hi")) {
        return "Hello! How can I assist you with Books4Geeks today?";
      } else if (userInput.includes("book") || userInput.includes("books")) {
        return "Our system has a wide selection of books. You can browse by category, author, or publisher using the sidebar menu.";
      } else if (userInput.includes("author")) {
        return "You can manage authors in the Book Management > Authors section.";
      } else if (
        userInput.includes("category") ||
        userInput.includes("categories")
      ) {
        return "Categories can be managed in the Book Management > Categories section.";
      } else if (
        userInput.includes("publisher") ||
        userInput.includes("publishers")
      ) {
        return "Publishers can be managed in the Book Management > Publishers section.";
      } else if (userInput.includes("help")) {
        return "I can help you navigate the Books4Geeks system. Try asking about books, authors, categories, or publishers.";
      } else if (userInput.includes("thank")) {
        return "You're welcome! Is there anything else you'd like to know?";
      } else {
        return "I'm not sure I understand. Could you try rephrasing your question? You can ask about books, authors, categories, or publishers.";
      }
    }

    // Attach send button click event
    if (sendButton) {
      sendButton.addEventListener("click", function () {
        sendMessage();
      });
    }

    // Attach enter key event
    if (userInput) {
      userInput.addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          sendMessage();
        }
      });
    }

    // Add a global debug function that the user can call from the browser console
    window.toggleChatbot = function () {
      console.log("Manual chatbot toggle called");
      chatbotContainer.style.display = "flex";
      chatbotContainer.style.zIndex = "9999";
    };

    console.log(
      "Chatbot initialization complete. Type window.toggleChatbot() in console to manually show the chatbot"
    );
  });
</script>

<!-- Add a simple button at the very bottom of the page as a fallback -->
<div
  style="position: fixed; bottom: 10px; right: 10px; z-index: 10000"
  id="fallback-chat-button"
>
  <button
    onclick="document.getElementById('chatbot-container').style.display='flex'; this.style.display='none';"
    style="
      padding: 10px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    "
  >
    <i class="fas fa-comments"></i>
  </button>
</div>
